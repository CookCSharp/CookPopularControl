<UserControl x:Class="MvvmTestDemo.UserControls.AnimationDemo"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:PresentationOptions="http://schemas.microsoft.com/winfx/2006/xaml/presentation/options"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:MvvmTestDemo.UserControls"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:pc="https://Chance.CookPopularControl/2021/xaml"
             mc:Ignorable="d"
             d:DesignHeight="800"
             d:DesignWidth="800"
             Width="400"
             Height="800"
             Background="White">

    <UserControl.Resources>
        <Geometry x:Key="SinData">M12.5,27.077196 C12.5,27.077196 12.500094,27.077196 12.5,1.6925709    31.25,1.6925709 31.25,18.615654 50,18.615654   68.75,18.615654 68.75,1.6925709 87.5,1.6925709   87.499909,27.077196 87.5,27.077107 87.5,27.077107</Geometry>
        <PathGeometry x:Key="SinWave" Figures="M12.5,1.6925709 C31.25,1.6925709 31.25,18.615654 50,18.615654 68.75,18.615654 68.75,1.6925709 87.5,1.6925709 87.499909,27.077196 87.5,27.077107 87.5,27.077107 63.28125,27.077136 12.5,27.077196 12.5,27.077196 12.5,27.077196 12.500094,27.077196 12.5,1.6925709 z" />
        <local:ConverterY x:Key="ConverterY" />
        <Storyboard x:Key="Wave">
            <DoubleAnimation Storyboard.TargetName="ellipse1" Storyboard.TargetProperty="(Shape.Fill).(Brush.RelativeTransform).(TransformGroup.Children)[3].(TranslateTransform.X)"
                             From="0" To="1" Duration="0:0:1"
                             RepeatBehavior="Forever" />
            <!--<DoubleAnimation Storyboard.TargetProperty="(UIElement.OpacityMask).(Brush.RelativeTransform).(TransformGroup.Children)[3].(TranslateTransform.X)"
                             Storyboard.TargetName="ellipse1" RepeatBehavior="Forever" From="0" To="1" Duration="0:0:1" />-->
        </Storyboard>
    </UserControl.Resources>
    <UserControl.Triggers>
        <EventTrigger RoutedEvent="FrameworkElement.Loaded">
            <BeginStoryboard Storyboard="{StaticResource Wave}" />
        </EventTrigger>
    </UserControl.Triggers>

    <ScrollViewer Background="White">
        <StackPanel>
            <Canvas>
                <Canvas.Resources>
                    <PathGeometry x:Key="path">
                        <PathFigure IsClosed="True" StartPoint="40,40">
                            <LineSegment Point="40,130" />
                            <ArcSegment Point="60,150" Size="20,20" />
                            <LineSegment Point="200,150" />
                            <ArcSegment Point="220,130" Size="20,20" />
                            <LineSegment Point="220,40" />
                            <ArcSegment Point="200,20" Size="20,20" />
                            <LineSegment Point="60,20" />
                            <ArcSegment Point="40,40" Size="20,20" />
                        </PathFigure>
                    </PathGeometry>
                    <Storyboard x:Key="pathStoryboard">
                        <MatrixAnimationUsingPath AutoReverse="True" DoesRotateWithTangent="True"
                                                  PathGeometry="{StaticResource path}"
                                                  Storyboard.TargetName="ButtonMatrixTransform" Storyboard.TargetProperty="Matrix"
                                                  Duration="0:0:5" RepeatBehavior="Forever" />
                    </Storyboard>
                </Canvas.Resources>
                <Canvas.Triggers>
                    <EventTrigger RoutedEvent="Control.Loaded">
                        <BeginStoryboard Storyboard="{StaticResource pathStoryboard}" />
                    </EventTrigger>
                </Canvas.Triggers>
                <Path Data="{StaticResource path}" Stroke="Black" StrokeThickness="3" />
                <Ellipse Fill="#f00" Width="20" Height="20">
                    <Ellipse.RenderTransform>
                        <MatrixTransform x:Name="ButtonMatrixTransform" />
                    </Ellipse.RenderTransform>
                </Ellipse>
            </Canvas>

            <Canvas>
                <Canvas.Resources>
                    <PathGeometry x:Key="path">
                        <PathFigure IsClosed="True" StartPoint="40,40">
                            <LineSegment Point="40,130" />
                            <ArcSegment Point="60,150" Size="20,20" />
                            <LineSegment Point="200,150" />
                            <ArcSegment Point="220,130" Size="20,20" />
                            <LineSegment Point="220,40" />
                            <ArcSegment Point="200,20" Size="20,20" />
                            <LineSegment Point="60,20" />
                            <ArcSegment Point="40,40" Size="20,20" />
                        </PathFigure>
                    </PathGeometry>
                    <Storyboard x:Key="pathStoryboard">
                        <DoubleAnimationUsingPath PathGeometry="{StaticResource path}"
                                                  Source="X"
                                                  Storyboard.TargetName="translateTransform" Storyboard.TargetProperty="X"
                                                  Duration="0:0:5" RepeatBehavior="Forever" />
                        <DoubleAnimationUsingPath PathGeometry="{StaticResource path}"
                                                  Source="Y"
                                                  Storyboard.TargetName="translateTransform" Storyboard.TargetProperty="Y"
                                                  Duration="0:0:5" RepeatBehavior="Forever" />
                    </Storyboard>
                </Canvas.Resources>

                <Canvas.Triggers>
                    <EventTrigger RoutedEvent="Control.Loaded">
                        <BeginStoryboard Storyboard="{StaticResource pathStoryboard}" />
                    </EventTrigger>
                </Canvas.Triggers>

                <Path Data="{StaticResource path}" Stroke="Black" StrokeThickness="1" />

                <Path Fill="#eee">
                    <Path.Data>
                        <EllipseGeometry x:Name="ellipses"
                                         Center="5,5" RadiusX="12" RadiusY="12" />
                    </Path.Data>
                    <Path.RenderTransform>
                        <TranslateTransform x:Name="translateTransform" />
                    </Path.RenderTransform>
                </Path>
            </Canvas>

            <Canvas Grid.Row="1">
                <Canvas.Resources>
                    <PathGeometry x:Key="path" Figures="M 10,100 C 35,0 135,0 160,100 180,190 285,200 310,100" />
                    <Storyboard x:Key="pathStoryboard">
                        <PointAnimationUsingPath PathGeometry="{StaticResource path}"
                                                 Storyboard.TargetName="ellipse" Storyboard.TargetProperty="Center"
                                                 Duration="0:0:5" RepeatBehavior="Forever">
                            <!--  RepeatBehavior="0:0:8"  -->
                        </PointAnimationUsingPath>
                    </Storyboard>
                </Canvas.Resources>
                <Canvas.Triggers>
                    <EventTrigger RoutedEvent="Control.Loaded">
                        <BeginStoryboard Storyboard="{StaticResource pathStoryboard}" />
                    </EventTrigger>
                </Canvas.Triggers>

                <Path Data="{StaticResource path}" Stroke="Black" StrokeThickness="1" />
                <Path Fill="Green">
                    <Path.Data>
                        <EllipseGeometry x:Name="ellipse"
                                         Center="5,5" RadiusX="12" RadiusY="12" />
                    </Path.Data>
                </Path>
            </Canvas>

            <Canvas Width="400" Height="400">
                <Button Content="A Button" MinWidth="100">
                    <Button.RenderTransform>
                        <MatrixTransform x:Name="ButtonMatrixTransform1">
                            <MatrixTransform.Matrix>
                                <Matrix />
                            </MatrixTransform.Matrix>
                        </MatrixTransform>
                    </Button.RenderTransform>
                    <Button.Triggers>
                        <EventTrigger RoutedEvent="Button.Loaded">
                            <BeginStoryboard>
                                <Storyboard>
                                    <MatrixAnimationUsingPath DoesRotateWithTangent="True"
                                                              Storyboard.TargetName="ButtonMatrixTransform1" Storyboard.TargetProperty="Matrix"
                                                              Duration="0:0:5" RepeatBehavior="Forever">
                                        <MatrixAnimationUsingPath.PathGeometry>
                                            <PathGeometry PresentationOptions:Freeze="True" Figures="M 10,100 C 35,0 135,0 160,100 180,190 285,200 310,100" />
                                        </MatrixAnimationUsingPath.PathGeometry>
                                    </MatrixAnimationUsingPath>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Button.Triggers>
                </Button>
            </Canvas>

            <Canvas>
                <Ellipse x:Name="ellipse1"
                         Stroke="Green" StrokeThickness="5"
                         Canvas.Left="320" Canvas.Top="80"
                         Width="160" Height="160">
                    <Ellipse.Fill>
                        <VisualBrush AutoLayoutContent="True" Stretch="None" TileMode="Tile"
                                     Viewport="0,-1,1,5" ViewportUnits="RelativeToBoundingBox">
                            <VisualBrush.Visual>
                                <Grid x:Name="wave"
                                      Width="160" Height="160"
                                      Background="Transparent">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="20" />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Path Grid.Row="0"
                                          Data="{StaticResource SinFuncGeometry}"
                                          Fill="Purple" Stretch="Fill" Stroke="Red"
                                          StrokeThickness="2" />
                                    <Rectangle Fill="Purple" Grid.Row="1" Margin="0,-2,0,0" />
                                </Grid>
                            </VisualBrush.Visual>
                            <VisualBrush.RelativeTransform>
                                <TransformGroup>
                                    <ScaleTransform />
                                    <SkewTransform />
                                    <RotateTransform />
                                    <TranslateTransform Y="{Binding Value, ElementName=y, Converter={StaticResource ConverterY}}" />
                                </TransformGroup>
                            </VisualBrush.RelativeTransform>
                        </VisualBrush>
                    </Ellipse.Fill>
                </Ellipse>
                <Slider x:Name="y"
                        Maximum="100" Minimum="0"
                        Width="200"
                        Value="0" />
                <TextBlock Canvas.Top="23" Text="{Binding ElementName=y, Path=Value}" FontSize="20" />
                <Slider x:Name="amplitude"
                        Maximum="160" Minimum="1"
                        Canvas.Top="43"
                        Width="200"
                        Value="20" />
                <TextBlock Canvas.Top="63" Text="{Binding ElementName=amplitude, Path=Value}" FontSize="20" />
            </Canvas>
            <Path Grid.Row="1"
                  Data="M12.5,27.077196 C12.5,27.077196 12.500094,27.077196 12.5,1.6925709    31.25,1.6925709 31.25,18.615654 50,18.615654   68.75,18.615654 68.75,1.6925709 87.5,1.6925709   87.499909,27.077196 87.5,27.077107 87.5,27.077107" Fill="Green" Stretch="Fill"
                  Stroke="Red" StrokeThickness="2"
                  Width="300" Height="50" />
        </StackPanel>
    </ScrollViewer>

</UserControl>
